# Incident 2025-08-13

## Utilisateurs affectés

Tous

## Systèmes affectés

- Tous les services Kubernetes (indisponibilité)
- VPN (indisponibilité)

## Description de l'événement

Tous les services étaient indisponibles après une perte/reprise de courant à l'ÉTS. En effet, plusieurs VMs ont échouer à redémarrer après que le courant soit revenu. Par conséquent, seule une partie de nos services a pu être remise en ligne, tandis que ceux reposant sur des données persistantes hébergées sur les nœuds arrêtés présentaient un état dégradé. De plus, le VPN étaient indisponible après la perte de courant, ce qui a affecté notre capacité à répondre rapidement à l'incident.

## Causes sources

1. Perte de courant
2. Mauvaise configuration des VMs
3. Mauvaise configuration du BIOS du VPN (démarrage on power loss)

## Timeline

**9:58** - Panne de courant (système down)

**10:01** - Alerte envoyé

**10:21** - Systèmes rétablis, mais environ 1/3 des VMs Kubernetes sont UP

**10:44** - Club CÉDILLE débute l'investigation

**11:10** - Tentative de connexion au VPN échoue, le VPN semble off.

**11:21** - Matai du LanETS a un accès via une des VMs du LAN qui est up, aide les membres du club à investiguer le problème

**11:28** - Les VMs sont toutes redémarrés

**11:35** - Les nodes sont tous disponibles, on recoit des notifications de rétablissement des serveurs

**11:43** - Certains PVC semblent avoir des mount fails, recrréer les pods semble régler le problème. Principalement les pods de CNPG sont affectés et entrent en CrashLoopBackOff ; la suppression et la recréation de ces pods permettent de résoudre le problème (ex. : Nextcloud).

**12:05** - Tous les services sont de retours à la normale

## Prochaines étapes

Le club CÉDILLE investiguera les configurations des VMs afin d'identifier les causes possibles du problème.
De plus, le BIOS du VPN sera reconfiguré afin qu'il démarre automatiquement après une perte de courant
Il faut aussi élaborer une stratégie lors de fail mounts qui peuvent arriver lors d'un démarrage à froid du cluster.

## Métriques

| Nom | Valeure |
|---|---|
| Failure time | 2h07min |
| Response time | 1h46min |
| Repair time | 1h21min |
